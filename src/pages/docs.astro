---
import Aside from "../components/docs/Aside.astro";
import Content from "../components/docs/Content.astro";
import Layout from "../layouts/Layout.astro";
---

<Layout title="Documentacion">
  <section class="flex min-h-screen">
    <Aside />
    <Content />
  </section>
</Layout>

<style>
  :root {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  }
  html {
    scroll-behavior: smooth;
    scroll-padding-block-start: 80px;
  }
</style>

<script>
  const setCurrent: IntersectionObserverCallback = (entries) => {
    for (let entry of entries) {
      const { id } = entry.target;
      const aElement = document.querySelector(`#sidebar a[href="#${id}"]`);
      const liElement = document.querySelector(`#sidebar li[data-id="${id}"]`);
      if (!aElement) return;
      if (!liElement) return;

      if (entry.isIntersecting) {
        document
          .querySelectorAll("#sidebar a")
          .forEach((e) => e.classList.remove("active"));
        document
          .querySelectorAll("#sidebar li")
          .forEach((e) => e.classList.remove("active"));
        aElement.classList.add("active");
        liElement.classList.add("active");
      }
    }
  };

  const observerOption = {
    rootMargin: "0px 0px 0px 0px",
    threshold: 0.8,
  };

  const headingObserver = new IntersectionObserver(setCurrent, observerOption);
  document.querySelectorAll(".content section").forEach((heading) => {
    headingObserver.observe(heading);
  });
  // aside size
  // document.addEventListener("DOMContentLoaded", () => {
  //   const adjustAside = () => {
  //     console.log('ajustando')
  //     const footerHeight = document.querySelector('.footer')?.offsetHeight;
  //     const headerHeight = document.querySelector('.navbar')?.offsetHeight;
  //     const sidebar = document.getElementById('sidebar');
  //     console.log(footerHeight, headerHeight, sidebar.offsetHeight)
  //     sidebar.style.maxHeight = `calc(100vh - ${headerHeight}px - ${footerHeight}px)`;
  //   };

  //   // Ajustar al cargar y al redimensionar la ventana
  //   adjustAside();
  //   window.addEventListener('resize', adjustAside);
  // });
</script>
